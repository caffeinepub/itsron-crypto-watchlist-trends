{
  "kind": "build_request",
  "title": "Add CoinGecko raw-response debug endpoint and validate getLiveMarketData symbols",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add a public shared Motoko debug endpoint `debugFetchCoinGecko(symbol : CryptoSymbol) : async Text` in `backend/main.mo` that builds the CoinGecko URL for the given symbol, performs the HTTP GET outcall, prints debug logs (URL + raw response), and returns the raw response body as `Text`, matching the user-provided function behavior.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Add this debug function to main.mo:\nmotokopublic shared func debugFetchCoinGecko(symbol : CryptoSymbol) : async Text {\n  switch (buildCoinGeckoUrl(symbol)) {\n    case (?url) {\n      Debug.print(\"Fetching: \" # url);\n      let result = await OutCall.httpGetRequest(url, [], transform);\n      Debug.print(\"Raw response: \" # result);\n      result\n    };\n    case (null) { \"Error: Could not build URL\" };\n  };\n};"
        ]
      },
      "acceptanceCriteria": [
        "`dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"BTC\")'` returns a non-empty `Text` response when the CoinGecko call succeeds.",
        "Canister logs include lines starting with `Fetching:` and `Raw response:` for each call.",
        "If `buildCoinGeckoUrl(symbol)` cannot build a URL, the function returns exactly `Error: Could not build URL` (as `Text`)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Ensure the backend canister exposes `getLiveMarketData(symbol : CryptoSymbol)` callable via `dfx canister call itsron_crypto_backend getLiveMarketData '(\"BTC\")'` / `(\"ETH\")` / `(\"XRP\")`, and that it uses the same CoinGecko URL-building logic as `debugFetchCoinGecko` so live-data failures can be debugged consistently.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "dfx canister call itsron_crypto_backend getLiveMarketData '(\"BTC\")'\n\n# Test ETH\ndfx canister call itsron_crypto_backend getLiveMarketData '(\"ETH\")'\n\n# Test XRP\ndfx canister call itsron_crypto_backend getLiveMarketData '(\"XRP\")'"
        ]
      },
      "acceptanceCriteria": [
        "`getLiveMarketData` is present in the candid interface and callable for BTC/ETH/XRP via `dfx canister call ...` without method-not-found errors.",
        "When CoinGecko is reachable, `getLiveMarketData` returns successfully for BTC, ETH, and XRP.",
        "When CoinGecko is unreachable or returns an error, developers can call `debugFetchCoinGecko` for the same symbol and receive the raw response used to diagnose the issue."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Preserve the existing user-profile and authorization behavior currently implemented in `backend/main.mo` (profile getters/setter and access control mixin) while adding the new crypto debug and live-market-data functions.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Add this debug function to main.mo"
        ]
      },
      "acceptanceCriteria": [
        "Existing methods `getCallerUserProfile`, `getUserProfile`, and `saveCallerUserProfile` still compile and behave as before (no signature changes, no removed access checks).",
        "The canister builds successfully with both profile features and the newly added crypto endpoints present."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in `backend/main.mo` (no additional backend services).",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Do not claim to run `dfx` commands or provide real command output in the app build; only implement the endpoints so the user can run the commands locally.",
    "No frontend UI changes are required for this request."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}