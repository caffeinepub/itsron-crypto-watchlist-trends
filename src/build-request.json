{
  "kind": "build_request",
  "title": "Deploy and validate CoinGecko debug fetch via dfx (BTC/ETH/XRP)",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-6",
      "text": "Ensure the backend canister exposes an admin-only `debugFetchCoinGecko(symbol : CryptoSymbol) : async Text` method that returns the raw CoinGecko HTTP response body as `Text` for supported symbols (BTC, ETH, XRP) and returns the exact error text `\"❌ Error: Could not build URL for symbol: \" # symbol` when the URL cannot be built.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "Now deploy and test the debug function to see the raw CoinGecko responses:"
        ]
      },
      "acceptanceCriteria": [
        "`dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"BTC\")'` returns a raw CoinGecko response body as a `Text` value (not a trap).",
        "`dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"ETH\")'` returns a raw CoinGecko response body as a `Text` value (not a trap).",
        "`dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"XRP\")'` returns a raw CoinGecko response body as a `Text` value (not a trap).",
        "Calling `debugFetchCoinGecko` with an unsupported symbol returns exactly: `❌ Error: Could not build URL for symbol: <SYMBOL>` (with the provided symbol appended).",
        "`debugFetchCoinGecko` traps with an authorization error for non-admin callers (admin-only gating remains enforced)."
      ]
    },
    {
      "id": "REQ-7",
      "text": "Refactor `getLiveMarketData(symbol : CryptoSymbol)` to use the same CoinGecko URL-building logic as `debugFetchCoinGecko` (i.e., `buildCoinGeckoUrl(symbol)`) so both methods are consistent for BTC/ETH/XRP and unsupported symbol handling is deterministic.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "Now deploy and test the debug function to see the raw CoinGecko responses:"
        ]
      },
      "acceptanceCriteria": [
        "For BTC/ETH/XRP, `getLiveMarketData` uses the same final URL string that `debugFetchCoinGecko` would log/print for the same symbol.",
        "For unsupported symbols, `getLiveMarketData` returns a clear English error string (no traps) indicating the symbol is unsupported.",
        "`dfx canister call itsron_crypto_backend getLiveMarketData '(\"BTC\")'` returns a raw CoinGecko response body as `Text` (JSON string) for an authorized user caller."
      ]
    },
    {
      "id": "REQ-8",
      "text": "Add a developer-facing documentation file that includes the exact deploy and test commands to validate raw CoinGecko responses via `dfx`, using the canister name `itsron_crypto_backend` and covering BTC, ETH, and XRP.",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "bashdfx deploy itsron_crypto_backend",
          "# Test BTC",
          "dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"BTC\")'",
          "# Test ETH  ",
          "dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"ETH\")'",
          "# Test XRP",
          "dfx canister call itsron_crypto_backend debugFetchCoinGecko '(\"XRP\")'"
        ]
      },
      "acceptanceCriteria": [
        "Repo contains a new documentation file (e.g., under a `docs/` directory or in `README.md`) with the deploy command and the three `dfx canister call` examples for BTC/ETH/XRP exactly as provided by the user (user-facing text in English).",
        "The documented commands, when run after deployment, successfully execute against the local/dev environment without requiring code changes to follow the steps."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in `backend/main.mo` (no additional backend services).",
    "Preserve existing user-profile storage and authorization behavior already implemented in `backend/main.mo`.",
    "Do not modify any files under `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, or `frontend/src/components/ui`.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Fixing the frontend “Connecting to backend” caching/canister-ID issue (not requested in the latest message).",
    "Adding new cryptocurrencies beyond BTC, ETH, and XRP.",
    "Adding third-party services, databases, or non-Motoko backend components."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}