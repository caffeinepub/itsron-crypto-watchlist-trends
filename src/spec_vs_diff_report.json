{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-07T20:19:23.753Z",
  "summary": "Diff implements a 45s timeout + actionable error UI for backend connection, adds connection error normalization utilities, updates WatchlistPriceTickRow to show cycle-exhaustion-specific messaging, and modifies the actor hook diagnostics/stage handling. However, evidence is insufficient that non-timeout actor-creation failures (e.g., missing canister ID) are surfaced as real errors, and the watchlist cycle-exhaustion copy does not explicitly mention “until cycles are topped up” as required. Several unrelated UI/content changes appear in the diff summary beyond the requested scope.",
  "missing_requirements": [
    {
      "id": "REQ-28",
      "requirement": "If the backend actor cannot be created due to missing/invalid configuration (including missing canister ID), the user sees an English error screen (not an infinite spinner) within 45 seconds with actionable buttons (Retry Connection, Re-authenticate, Refresh Page).",
      "reason": "The timeout path is implemented (45s) and error UI/actions appear to exist, but the diff does not show explicit detection/handling of missing/invalid canister ID at actor-creation time—only a timeout fallback. It’s unclear that a misconfiguration will produce an error screen without waiting for timeout, or that actor creation is actually attempted/re-discovered when the cached canister ID is missing.",
      "evidence": [
        "frontend/src/hooks/useActorEnhanced.ts",
        "frontend/src/components/ConnectionBootstrapper.tsx",
        "frontend/src/utils/connectionErrors.ts"
      ]
    },
    {
      "id": "REQ-28",
      "requirement": "Retry actions actually trigger a new actor-creation attempt (not just re-rendering the same idle state).",
      "reason": "ConnectionBootstrapper wires an onRetry handler and resets local timers, but the diff is truncated where useActorEnhanced.retry is implemented, so it’s not verifiable from the provided summary that a retry forces a fresh actor-creation attempt (e.g., re-init/invalidate the underlying actor creation) rather than only resetting UI state.",
      "evidence": [
        "frontend/src/components/ConnectionBootstrapper.tsx",
        "frontend/src/hooks/useActorEnhanced.ts"
      ]
    },
    {
      "id": "REQ-29",
      "requirement": "Harden the actor initialization hook so it reliably reports errors when actor creation fails (including missing canister ID / misconfiguration) instead of silently staying in an idle/loading state, and ensure the error is propagated to the existing connection UI (ConnectionBootstrapper / ConnectionDetails).",
      "reason": "useActorEnhanced sets stage to 'creating-actor' when authenticated but not fetching to avoid an 'idle' stall, and it produces an Error on timeout. But there’s no visible wiring for propagating actual actor-creation exceptions (e.g., missing canister ID) as Error objects; the hook’s error appears to be derived only from a 45s timeout in the shown portion.",
      "evidence": [
        "frontend/src/hooks/useActorEnhanced.ts",
        "frontend/src/utils/connectionErrors.ts",
        "frontend/src/components/ConnectionBootstrapper.tsx",
        "frontend/src/components/ConnectionDetails.tsx"
      ]
    },
    {
      "id": "REQ-30",
      "requirement": "Cycle-exhaustion errors display an English message explicitly mentioning the backend is out of cycles and that live data is temporarily unavailable until cycles are topped up.",
      "reason": "The updated tick row uses getCycleExhaustionMessage(), which currently returns 'Backend out of cycles - live data temporarily unavailable' and does not explicitly include 'until cycles are topped up' (or equivalent wording) as required by the acceptance criteria.",
      "evidence": [
        "frontend/src/components/WatchlistPriceTickRow.tsx",
        "frontend/src/utils/connectionErrors.ts"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Broad UI/content changes and feature messaging changes in unrelated components (e.g., LoginPrompt visuals, Dashboard layout, AddCryptoDialog/WatchlistManager messaging, global CSS color system tweaks).",
      "reason": "These changes are not requested by REQ-28/29/30 and appear unrelated to fixing connection bootstrap stalling or watchlist tick cycle error messaging.",
      "evidence": [
        "frontend-file-summaries.txt",
        "frontend/src/index.css",
        "frontend/src/pages/Dashboard.tsx",
        "frontend/src/components/LoginPrompt.tsx",
        "frontend/src/components/AddCryptoDialog.tsx",
        "frontend/src/components/WatchlistManager.tsx"
      ]
    },
    {
      "description": "Added generalized actor/network/config error normalization utilities (normalizeActorError, isConfigurationError) including admin-contact phrasing.",
      "reason": "REQ-28/29 request better error surfacing and diagnostics, but the specific additional normalization behaviors and wording (e.g., 'Please contact the administrator') are not explicitly requested; this may be extra behavior beyond the spec.",
      "evidence": [
        "frontend/src/utils/connectionErrors.ts"
      ]
    }
  ],
  "confidence": 0.62,
  "changed_files": [
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/ConnectionBootstrapper.tsx",
    "frontend/src/components/ConnectionDetails.tsx",
    "frontend/src/components/WatchlistPriceTickRow.tsx",
    "frontend/src/hooks/useActorEnhanced.ts",
    "frontend/src/utils/connectionErrors.ts",
    "project_state.json"
  ]
}